<div class="content">
    <div class="content-header">
        <h4>Search Movies</h4>
        <mat-form-field class="full-width">
            <input
                matInput
                [formControl]="searchControl"
                [matAutocomplete]="auto"
                placeholder="Search Movies"
            >
            <mat-autocomplete
                autoActiveFirstOption
                #auto="matAutocomplete"
            >
                @for (option of filteredOptions | async; track option) {
                <mat-option [value]="option">{{ option }}</mat-option>
                }
            </mat-autocomplete>
        </mat-form-field>
    </div>

    <div class="content-body">
        <h4>Search Results:</h4>

        <cdk-virtual-scroll-viewport
            itemSize="100"
            class="viewport"
            appendOnly
            #virtualScrollViewport
        >
            <div
                *cdkVirtualFor="let movie of movies$ | async; trackBy: trackByFn"
                class="grid-container movie-item"
            >
                <div class="movie-poster">
                    <img
                        [src]="movie.Poster"
                        [alt]="movie.Title"
                        (error)="onImageError($event)"
                    />
                </div>
                <div class="movie-information">
                    <span class="movie-title text-bold">{{ movie.Title }}</span>
                    <br />
                    <span class="movie-year">{{ movie.Year }}</span>
                </div>
            </div>
        </cdk-virtual-scroll-viewport>
    </div>

    <div class="content-footer">
        @if (loading) {
        <mat-spinner [diameter]="20"></mat-spinner>
        }

        @if ((movies$ | async)?.length) {
        <span class="text-italic">Displaying {{ (movies$ | async)?.length }} of {{ (totalResults$ | async) }} results.</span>
        }
    </div>
</div>
